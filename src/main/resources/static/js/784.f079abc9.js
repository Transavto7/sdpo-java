"use strict";(self["webpackChunksdpo_frontend"]=self["webpackChunksdpo_frontend"]||[]).push([[784],{4784:function(n,t,e){e.r(t),e.d(t,{default:function(){return p}});var i=e(3396),a=e(7139);const o={class:"step-photo__outer"},s=(0,i._)("h3",{class:"animate__animated animate__fadeInDown"},"Сделайте снимок",-1),d={key:0,class:"admin__loading animate__animated animate__fadeInUp"},r=(0,i._)("div",{class:"lds-ring"},[(0,i._)("div"),(0,i._)("div"),(0,i._)("div"),(0,i._)("div")],-1),c={ref:"video"},l={key:2,class:"step-photo__btns"};function _(n,t,e,_,h,u){return(0,i.wg)(),(0,i.iD)("div",o,[s,h.loading?((0,i.wg)(),(0,i.iD)("div",d,[r,(0,i.Uk)(" Загрузка ")])):(0,i.kq)("",!0),h.loading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,a.C_)(["step-photo__video animate__animated animate__fadeInDown",{preview:!h.translation}])},[(0,i._)("img",c,null,512)],2)),h.loading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",l,[h.translation?((0,i.wg)(),(0,i.iD)("button",{key:0,onClick:t[0]||(t[0]=n=>h.translation=!1),class:"btn animate__animated animate__fadeInDown"},"Фотография")):(0,i.kq)("",!0),h.translation?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:t[1]||(t[1]=n=>u.next()),class:"btn blue animate__animated animate__fadeInDown"},"Сохранить")),h.translation?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("button",{key:2,onClick:t[2]||(t[2]=n=>h.translation=!0),class:"btn animate__animated animate__fadeInDown"},"Отмена"))]))])}e(7658);var h=e(6509),u={data(){return{connection:null,image:null,translation:!0,loading:!0}},mounted(){this.driver.photo?this.$router.push({name:"step-ride"}):this.connect()},unmounted(){this.disconnect()},computed:{inspection(){return this.$store.state.inspection},driver(){return this.$store.state.driver??{}}},methods:{next(){const n=new FileReader;n.readAsDataURL(this.image),n.onloadend=()=>{(0,h.S1)(this.driver?.hash_id,n.result.split(",")[1])},this.$router.push({name:"step-ride"})},connect(){this.connection=new WebSocket("ws://localhost:8080/video"),this.connection.onmessage=n=>{if(this.translation){this.loading=!1;const t=n.data,e=URL.createObjectURL(t);this.$refs.video.src=e,this.image=t}},this.connection.onopen=n=>{console.log("Successfully connected to the echo websocket server...")},this.connection.error=n=>{console.log(n)}},async disconnect(){console.log("Disconnect websoket server"),await(0,h.rd)()}}},m=e(89);const k=(0,m.Z)(u,[["render",_]]);var p=k}}]);
//# sourceMappingURL=784.f079abc9.js.map