"use strict";(self["webpackChunksdpo_frontend"]=self["webpackChunksdpo_frontend"]||[]).push([[165],{6165:function(n,e,t){t.r(e),t.d(e,{default:function(){return g}});var i=t(3396),a=t(7139);const o={class:"step-photo__outer"},s=(0,i._)("h3",{class:"animate__animated animate__fadeInDown"},"Сделайте снимок",-1),d={key:0,class:"admin__loading animate__animated animate__fadeInUp"},r=(0,i._)("div",{class:"lds-ring"},[(0,i._)("div"),(0,i._)("div"),(0,i._)("div"),(0,i._)("div")],-1),c={ref:"video"},l={key:2,class:"step-photo__btns"};function _(n,e,t,_,h,u){return(0,i.wg)(),(0,i.iD)("div",o,[s,h.loading?((0,i.wg)(),(0,i.iD)("div",d,[r,(0,i.Uk)(" Загрузка ")])):(0,i.kq)("",!0),h.loading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,a.C_)(["step-photo__video animate__animated animate__fadeInDown",{preview:!h.translation}])},[(0,i._)("img",c,null,512)],2)),h.loading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",l,[h.translation?((0,i.wg)(),(0,i.iD)("button",{key:0,onClick:e[0]||(e[0]=n=>h.translation=!1),class:"btn animate__animated animate__fadeInDown"},"Фотография")):(0,i.kq)("",!0),h.translation?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:e[1]||(e[1]=n=>u.next()),class:"btn blue animate__animated animate__fadeInDown"},"Сохранить")),h.translation?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("button",{key:2,onClick:e[2]||(e[2]=n=>h.translation=!0),class:"btn animate__animated animate__fadeInDown"},"Отмена"))]))])}t(7658);var h=t(6509),u={data(){return{connection:null,image:null,translation:!0,loading:!0}},mounted(){console.log("asdasdads ",this.driver),this.driver.photo?this.$router.push({name:"step-ride"}):this.connect()},unmounted(){this.disconnect()},computed:{inspection(){return this.$store.state.inspection},driver(){return this.$store.state.driver??{}}},methods:{next(){const n=new FileReader;n.readAsDataURL(this.image),n.onloadend=()=>{(0,h.S1)(this.driver?.hash_id,n.result.split(",")[1])},this.$router.push({name:"step-ride"})},connect(){this.connection=new WebSocket("ws://localhost:8080/video"),this.connection.onmessage=n=>{if(this.translation){this.loading=!1;const e=n.data,t=URL.createObjectURL(e);this.$refs.video.src=t,this.image=e}},this.connection.onopen=n=>{console.log("Successfully connected to the echo websocket server...")},this.connection.error=n=>{console.log(n)}},async disconnect(){console.log("Disconnect websoket server"),await(0,h.rd)()}}},m=t(89);const v=(0,m.Z)(u,[["render",_]]);var g=v}}]);
//# sourceMappingURL=165.658ea353.js.map