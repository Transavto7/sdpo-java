"use strict";(self["webpackChunksdpo_frontend"]=self["webpackChunksdpo_frontend"]||[]).push([[645],{9645:function(e,s,a){a.r(s),a.d(s,{default:function(){return As}});var t=a(3396),n=a(7139);const i={class:"admin"},l={class:"admin__tabs"};function _(e,s,a,_,d,o){const c=(0,t.up)("testing"),m=(0,t.up)("tonometer"),r=(0,t.up)("password"),u=(0,t.up)("system");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t._)("div",l,[(0,t._)("button",{class:(0,n.C_)(["admin__tab animate__animated animate__fadeInDown d-1",{active:"system"===d.selected}]),onClick:s[0]||(s[0]=e=>d.selected="system")}," Основные настройки ",2),(0,t._)("button",{class:(0,n.C_)(["admin__tab animate__animated animate__fadeInDown d-2",{active:"password"===d.selected}]),onClick:s[1]||(s[1]=e=>d.selected="password")}," Настройки пароля ",2),(0,t._)("button",{class:(0,n.C_)(["admin__tab animate__animated animate__fadeInDown d-3",{active:"tonometer"===d.selected}]),onClick:s[2]||(s[2]=e=>d.selected="tonometer")}," Настройки танометра ",2),(0,t._)("button",{class:(0,n.C_)(["admin__tab animate__animated animate__fadeInDown d-4",{active:"testing"===d.selected}]),onClick:s[3]||(s[3]=e=>d.selected="testing")}," Тестирование ",2)]),"testing"===d.selected?((0,t.wg)(),(0,t.j4)(c,{key:0})):(0,t.kq)("",!0),"tonometer"===d.selected?((0,t.wg)(),(0,t.j4)(m,{key:1})):(0,t.kq)("",!0),"password"===d.selected?((0,t.wg)(),(0,t.j4)(r,{key:2})):(0,t.kq)("",!0),"system"===d.selected?((0,t.wg)(),(0,t.j4)(u,{key:3})):(0,t.kq)("",!0)])}const d={class:"admin__testing"},o=["disabled"],c=["disabled"],m=["disabled"],r=["disabled"],u={key:0,class:"admin__loading animate__animated animate__fadeInUp"},p=(0,t._)("div",{class:"lds-ring"},[(0,t._)("div"),(0,t._)("div"),(0,t._)("div"),(0,t._)("div")],-1),w={key:1,class:"admin__testing-result"},y=["src"],v={key:1,class:"admin__testing-video animate__animated animate__fadeInUp"},h=(0,t._)("video",{autoplay:"autoplay",controls:""},[(0,t._)("source",{src:"http://localhost:8080/video",type:"video/mp4"})],-1),b=[h],k={key:2,class:"admin__testing-temp animate__animated animate__fadeInUp"},f=(0,t._)("span",null,"°C",-1),g={key:3,class:"admin__testing-temp animate__animated animate__fadeInUp"};function U(e,s,a,i,l,_){return(0,t.wg)(),(0,t.iD)("div",d,[(0,t._)("button",{disabled:"loading"===l.show,onClick:s[0]||(s[0]=e=>_.photo()),class:"btn blue animate__animated animate__fadeInUp"},"Тестовый снимок",8,o),(0,t._)("button",{disabled:"loading"===l.show,onClick:s[1]||(s[1]=e=>_.video()),class:"btn blue animate__animated animate__fadeInUp d-1"},"Тестовое видео",8,c),(0,t._)("button",{disabled:"loading"===l.show,onClick:s[2]||(s[2]=e=>_.thermometer()),class:"btn blue animate__animated animate__fadeInUp d-2"},"Изерить температуру",8,m),(0,t._)("button",{disabled:"loading"===l.show,onClick:s[3]||(s[3]=e=>_.alcometer()),class:"btn blue animate__animated animate__fadeInUp d-3"},"Тест алкоголя",8,r),"loading"===l.show?((0,t.wg)(),(0,t.iD)("div",u,[p,(0,t.Uk)(" Загрузка ")])):((0,t.wg)(),(0,t.iD)("div",w,["image"===l.show?((0,t.wg)(),(0,t.iD)("img",{key:0,class:"animate__animated animate__fadeInUp",src:"data:image/jpg;base64,"+l.image64},null,8,y)):(0,t.kq)("",!0),"video"===l.show?((0,t.wg)(),(0,t.iD)("div",v,b)):(0,t.kq)("",!0),"temp"===l.show?((0,t.wg)(),(0,t.iD)("div",k,[(0,t.Uk)((0,n.zw)(l.temp)+" ",1),f])):(0,t.kq)("",!0),"alcometer"===l.show?((0,t.wg)(),(0,t.iD)("div",g,(0,n.zw)(void 0===l.alcometerPpm?"Не удалось получить результат":l.alcometerPpm+" ‰"),1)):(0,t.kq)("",!0)]))])}a(7625);var C=a(4677);const I=(0,C.pm)();async function D(){return await axios.post("device/photo").then((({data:e})=>e)).catch(V)}async function x(){return await axios.post("device/video").then((({data:e})=>e)).catch(V)}function V(e){const s=e.response?.data;if(s?.message)I.error(s.message);else switch(e?.response?.status){case 400:I.error("Ошибка авторизации запроса");default:I.error("Неизвестная ошибка запроса")}console.log(e)}const q=(0,C.pm)();async function z(){return await axios.post("device/scan").then((({data:e})=>e)).catch((async()=>{await j(5e3)}))}async function P(e){return await axios.post(`device/tonometer/${e}`).then((({data:e})=>e)).catch(Z)}async function j(e){return new Promise((s=>setTimeout(s,e)))}function Z(e){const s=e.response?.data;if(s?.message)q.error(s.message);else switch(e?.response?.status){case 400:q.error("Ошибка авторизации запроса");default:q.error("Неизвестная ошибка запроса")}console.log(e)}const $=(0,C.pm)();async function T(){return await axios.post("device/thermometer").then((({data:e})=>e)).catch(L)}function L(e){const s=e.response?.data;if(s?.message)$.error(s.message);else switch(e?.response?.status){case 400:$.error("Ошибка авторизации запроса");case 500:$.error("Ошибка сервера");default:$.error("Неизвестная ошибка запроса")}console.log(e)}const S=(0,C.pm)();async function A(){return await axios.post("device/alcometer").then((({data:e})=>e)).catch(E)}function E(e){const s=e.response?.data;if(s?.message)S.error(s.message);else switch(e?.response?.status){case 400:S.error("Ошибка авторизации запроса");case 500:S.error("Ошибка сервера");default:S.error("Неизвестная ошибка запроса")}console.log(e)}var H={data(){return{show:"",image64:null,temp:null,alcometerPpm:null,timeout:0,loading:!1}},methods:{async photo(){this.show="loading",this.image64=await D(),this.show="",this.image64&&(this.show="image")},async video(){this.show="loading";const e=await x();this.show="",e.duration&&(this.show="video")},async thermometer(){this.show="loading",this.temp=await T(),this.show="",this.temp&&(this.show="temp")},async alcometer(){this.show="loading",this.alcometerPpm=await A(),this.show="alcometer"}}},K=a(89);const R=(0,K.Z)(H,[["render",U]]);var W=R;const Y={key:0,class:"admin__loading animate__animated animate__fadeInUp"},B=(0,t._)("div",{class:"lds-ring"},[(0,t._)("div"),(0,t._)("div"),(0,t._)("div"),(0,t._)("div")],-1),F={key:1,class:"admin__tonometer"},G={class:"admin__tonometer-card animate__animated animate__fadeInUp d-1"},J=(0,t._)("div",{class:"admin__tonometer-card-title"}," Информация ",-1),M={class:"admin__tonometer-devices animate__animated animate__fadeInUp d-3"},N=["onClick"];function O(e,s,a,i,l,_){return l.result?((0,t.wg)(),(0,t.iD)("div",F,[(0,t._)("div",G,[J,(0,t._)("p",null,"Имя устройства: "+(0,n.zw)(l.result?.main?.name||"Неизвестное устройство"),1),(0,t._)("p",null,"Адрес устройства: "+(0,n.zw)(l.result?.main?.address||"Неизвестный адрес"),1),(0,t._)("p",null,"Подключенный тонометр: "+(0,n.zw)(l.connected||"-"),1)]),(0,t._)("div",M,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.result?.devices,(e=>((0,t.wg)(),(0,t.iD)("button",{class:"admin__tonometer-device",key:e.address,onClick:s=>_.connect(e.address)},(0,n.zw)(e.name||"Неизвестное устройство")+" - "+(0,n.zw)(e.address||"Неизвестный адрес"),9,N)))),128))])])):((0,t.wg)(),(0,t.iD)("div",Y,[B,(0,t.Uk)(" Загрузка ")]))}var Q={data(){return{result:null,connected:"",task:null}},methods:{async getDevices(){this.task=setInterval((async()=>{this.result=await z()}),1e3)},async connect(e){const s=await P(e);console.log(s)}},mounted(){this.getDevices()},unmounted(){clearInterval(this.task)}};const X=(0,K.Z)(Q,[["render",O]]);var ee=X,se=a(9242);const ae={class:"admin__password"},te={class:"password-form"},ne=(0,t._)("div",{class:"password-form__title animate__animated animate__fadeInDown"}," Введите новый пароль ",-1),ie={class:"password-form__input animate__animated animate__fadeIn d-1"},le={class:"number-buttons",ref:"numbers"},_e=(0,t._)("i",{class:"ri-close-fill"},null,-1),de=[_e],oe=(0,t._)("i",{class:"ri-delete-back-line"},null,-1),ce=[oe];function me(e,s,a,n,i,l){return(0,t.wg)(),(0,t.iD)("div",ae,[(0,t._)("div",te,[ne,(0,t._)("div",ie,[(0,t.wy)((0,t._)("input",{type:"password","onUpdate:modelValue":s[0]||(s[0]=e=>i.password=e)},null,512),[[se.nr,i.password]])]),(0,t._)("div",le,[(0,t._)("button",{class:"number-buttons__item",onClick:s[1]||(s[1]=e=>i.password+="1")},"1"),(0,t._)("button",{class:"number-buttons__item",onClick:s[2]||(s[2]=e=>i.password+="2")},"2"),(0,t._)("button",{class:"number-buttons__item",onClick:s[3]||(s[3]=e=>i.password+="3")},"3"),(0,t._)("button",{class:"number-buttons__item",onClick:s[4]||(s[4]=e=>i.password+="4")},"4"),(0,t._)("button",{class:"number-buttons__item",onClick:s[5]||(s[5]=e=>i.password+="5")},"5"),(0,t._)("button",{class:"number-buttons__item",onClick:s[6]||(s[6]=e=>i.password+="6")},"6"),(0,t._)("button",{class:"number-buttons__item",onClick:s[7]||(s[7]=e=>i.password+="7")},"7"),(0,t._)("button",{class:"number-buttons__item",onClick:s[8]||(s[8]=e=>i.password+="8")},"8"),(0,t._)("button",{class:"number-buttons__item",onClick:s[9]||(s[9]=e=>i.password+="9")},"9"),(0,t._)("button",{class:"number-buttons__item",onClick:s[10]||(s[10]=e=>i.password="")},de),(0,t._)("button",{class:"number-buttons__item",onClick:s[11]||(s[11]=e=>i.password+="0")},"0"),(0,t._)("button",{class:"number-buttons__item",onClick:s[12]||(s[12]=e=>i.password=i.password.slice(0,-1))},ce)],512),i.password.length>3?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:s[13]||(s[13]=(...e)=>l.save&&l.save(...e)),class:"btn animate__animated animate__fadeInUp"},"Сохранить")):(0,t.kq)("",!0)])])}var re=a(4457),ue={data(){return{password:"",toast:(0,C.pm)()}},methods:{async save(){await(0,re.vW)(this.password),this.password="",this.toast.success("Пароль успешно изменен"),this.$store.state.config.password=this.password}},mounted(){this.$refs.numbers.querySelectorAll("button").forEach(((e,s)=>{e.classList.add("animate__animated"),e.classList.add("animate__fadeInUp"),e.style.setProperty("animation-delay",.2+.05*s+"s")}))}};const pe=(0,K.Z)(ue,[["render",me]]);var we=pe;const ye={class:"admin__system"},ve={class:"admin__system-card animate__animated animate__fadeInUp d-1"},he=(0,t._)("div",{class:"admin__system-card__title"}," Основные настройки ",-1),be={class:"admin__system-card__item"},ke=(0,t._)("span",null,"Информация о водителе",-1),fe={class:"switch"},ge=(0,t._)("div",{class:"slider round"},null,-1),Ue={class:"admin__system-card__item"},Ce=(0,t._)("span",null,"Тип осмотра",-1),Ie={class:"switch"},De=(0,t._)("div",{class:"slider round"},null,-1),xe={class:"admin__system-card__item"},Ve=(0,t._)("span",null,"Вопрос о сне",-1),qe={class:"switch"},ze=(0,t._)("div",{class:"slider round"},null,-1),Pe={class:"admin__system-card__item"},je=(0,t._)("span",null,"вопрос о самочувствии",-1),Ze={class:"switch"},$e=(0,t._)("div",{class:"slider round"},null,-1),Te={class:"admin__system-card animate__animated animate__fadeInUp d-2"},Le=(0,t._)("div",{class:"admin__system-card__title"}," Алкометр ",-1),Se={class:"admin__system-card__item"},Ae=(0,t._)("span",null,"Быстрый режим",-1),Ee={class:"switch"},He=(0,t._)("div",{class:"slider round"},null,-1),Ke={class:"admin__system-card__item"},Re=(0,t._)("span",null,"Пропуск",-1),We={class:"switch"},Ye=(0,t._)("div",{class:"slider round"},null,-1),Be={class:"admin__system-card__item"},Fe=(0,t._)("span",null,"Показывать",-1),Ge={class:"switch"},Je=(0,t._)("div",{class:"slider round"},null,-1),Me={class:"admin__system-card animate__animated animate__fadeInUp d-3"},Ne=(0,t._)("div",{class:"admin__system-card__title"}," Тонометр ",-1),Oe={class:"admin__system-card__item"},Qe=(0,t._)("span",null,"Пропуск",-1),Xe={class:"switch"},es=(0,t._)("div",{class:"slider round"},null,-1),ss={class:"admin__system-card__item"},as=(0,t._)("span",null,"Показывать",-1),ts={class:"switch"},ns=(0,t._)("div",{class:"slider round"},null,-1),is={class:"admin__system-card animate__animated animate__fadeInUp d-4"},ls=(0,t._)("div",{class:"admin__system-card__title"}," Камера ",-1),_s={class:"admin__system-card__item"},ds=(0,t._)("span",null,"Видео",-1),os={class:"switch"},cs=(0,t._)("div",{class:"slider round"},null,-1),ms={class:"admin__system-card__item"},rs=(0,t._)("span",null,"Фото",-1),us={class:"switch"},ps=(0,t._)("div",{class:"slider round"},null,-1),ws={class:"admin__system-card animate__animated animate__fadeInUp d-5"},ys=(0,t._)("div",{class:"admin__system-card__title"}," Принтер ",-1),vs={class:"admin__system-card__item"},hs=(0,t._)("span",null,"Печать",-1),bs={class:"switch"},ks=(0,t._)("div",{class:"slider round"},null,-1),fs={class:"admin__system-card animate__animated animate__fadeInUp d-6"},gs=(0,t._)("div",{class:"admin__system-card__title"}," Термометер ",-1),Us={class:"admin__system-card__item"},Cs=(0,t._)("span",null,"Пропуск",-1),Is={class:"switch"},Ds=(0,t._)("div",{class:"slider round"},null,-1),xs={class:"admin__system-card__item"},Vs=(0,t._)("span",null,"Показывать",-1),qs={class:"switch"},zs=(0,t._)("div",{class:"slider round"},null,-1),Ps={class:"admin__system-footer animate__animated animate__fadeInUp d-7"};function js(e,s,a,n,i,l){return(0,t.wg)(),(0,t.iD)("div",ye,[(0,t._)("div",ve,[he,(0,t._)("div",be,[ke,(0,t._)("label",fe,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=e=>l.system.driver_info=e)},null,512),[[se.e8,l.system.driver_info]]),ge])]),(0,t._)("div",Ue,[Ce,(0,t._)("label",Ie,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=e=>l.system.type_ride=e)},null,512),[[se.e8,l.system.type_ride]]),De])]),(0,t._)("div",xe,[Ve,(0,t._)("label",qe,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=e=>l.system.question_sleep=e)},null,512),[[se.e8,l.system.question_sleep]]),ze])]),(0,t._)("div",Pe,[je,(0,t._)("label",Ze,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=e=>l.system.question_helth=e)},null,512),[[se.e8,l.system.question_helth]]),$e])])]),(0,t._)("div",Te,[Le,(0,t._)("div",Se,[Ae,(0,t._)("label",Ee,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=e=>l.system.alcometer_fast=e)},null,512),[[se.e8,l.system.alcometer_fast]]),He])]),(0,t._)("div",Ke,[Re,(0,t._)("label",We,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=e=>l.system.alcometer_skip=e)},null,512),[[se.e8,l.system.alcometer_skip]]),Ye])]),(0,t._)("div",Be,[Fe,(0,t._)("label",Ge,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=e=>l.system.alcometer_visible=e)},null,512),[[se.e8,l.system.alcometer_visible]]),Je])])]),(0,t._)("div",Me,[Ne,(0,t._)("div",Oe,[Qe,(0,t._)("label",Xe,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=e=>l.system.tonometer_skip=e)},null,512),[[se.e8,l.system.tonometer_skip]]),es])]),(0,t._)("div",ss,[as,(0,t._)("label",ts,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[8]||(s[8]=e=>l.system.tonometer_visible=e)},null,512),[[se.e8,l.system.tonometer_visible]]),ns])])]),(0,t._)("div",is,[ls,(0,t._)("div",_s,[ds,(0,t._)("label",os,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[9]||(s[9]=e=>l.system.camera_video=e)},null,512),[[se.e8,l.system.camera_video]]),cs])]),(0,t._)("div",ms,[rs,(0,t._)("label",us,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[10]||(s[10]=e=>l.system.camera_photo=e)},null,512),[[se.e8,l.system.camera_photo]]),ps])])]),(0,t._)("div",ws,[ys,(0,t._)("div",vs,[hs,(0,t._)("label",bs,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=e=>l.system.printer_write=e)},null,512),[[se.e8,l.system.printer_write]]),ks])])]),(0,t._)("div",fs,[gs,(0,t._)("div",Us,[Cs,(0,t._)("label",Is,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=e=>l.system.thermometer_skip=e)},null,512),[[se.e8,l.system.thermometer_skip]]),Ds])]),(0,t._)("div",xs,[Vs,(0,t._)("label",qs,[(0,t.wy)((0,t._)("input",{type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=e=>l.system.thermometer_visible=e)},null,512),[[se.e8,l.system.thermometer_visible]]),zs])])]),(0,t._)("div",Ps,[(0,t._)("button",{onClick:s[14]||(s[14]=(...e)=>l.save&&l.save(...e)),class:"btn blue"},"Сохранить")])])}var Zs={data(){return{toast:(0,C.pm)()}},methods:{async save(){await(0,re.hR)(this.system),this.toast.success("Настройки сохранены")}},computed:{system(){return this.$store.state.config?.system||{}}}};const $s=(0,K.Z)(Zs,[["render",js]]);var Ts=$s,Ls={components:{Testing:W,Tonometer:ee,Password:we,System:Ts},data(){return{selected:"system"}}};const Ss=(0,K.Z)(Ls,[["render",_]]);var As=Ss}}]);
//# sourceMappingURL=645.6c56d348.js.map