"use strict";(self["webpackChunksdpo_frontend"]=self["webpackChunksdpo_frontend"]||[]).push([[235],{2419:function(t,e,n){n.d(e,{NO:function(){return o},TQ:function(){return r},af:function(){return i},o:function(){return c}});var s=n(7625),a=n(4677);(0,a.pm)();async function i(){return await axios.post("device/photo").then((({data:t})=>t)).catch(l)}async function r(){return await axios.get("device/video/size").then((({data:t})=>t)).catch(l)}async function o(t){return await axios.post("device/media",{driver_id:t}).then((({data:t})=>t)).catch(l)}async function c(){return await axios.post("device/video/test").then((({data:t})=>t)).catch(l)}function l(t){t.response&&(s.Z.$state.loseConnect=!0),console.log(t)}},3386:function(t,e,n){n.r(e),n.d(e,{default:function(){return Z}});var s=n(3396),a=n(7139),i=n.p+"img/alco_guide.a6a48b74.png",r=n.p+"img/alco_guide_2.a5bbcd2d.png";const o={class:"step-alcometer__outer"},c={class:"step-alcometer"},l=(0,s._)("h3",{class:"animate__animated animate__fadeInDown"},"Проверка на алкоголь",-1),d={class:"step-alcometer__items"},u={key:0,class:"step-alcometer__item animate__animated animate__fadeInUp d-1"},h=(0,s._)("span",null,"1",-1),p=(0,s._)("img",{style:{"padding-right":"20px"},width:"100",src:i},null,-1),_=(0,s._)("label",null,"Проверьте, что вставлена воронка",-1),m=[h,p,_],v={key:1,class:"step-alcometer__item animate__animated animate__fadeInUp d-2"},y=(0,s._)("span",null,"2",-1),f=(0,s._)("img",{width:"100",src:r},null,-1),k={key:2,class:"step-alcometer__item animate__animated animate__fadeInUp d-1"},w=(0,s._)("span",{style:{"min-height":"30px"}},"3",-1),g=(0,s._)("img",{style:{"padding-right":"20px"},width:"100",src:i},null,-1),b={class:"step-alcometer__text animate__animated animate__fadeInUp d-2"},I=(0,s._)("br",null,null,-1),x=(0,s._)("br",null,null,-1),R=(0,s._)("br",null,null,-1),U=(0,s._)("br",null,null,-1),C=(0,s._)("br",null,null,-1),S={key:0,class:"alert red"},q=(0,s._)("i",{class:"ri-alarm-warning-fill"},null,-1),D={class:"step-buttons"};function N(t,e,n,i,r,h){return(0,s.wg)(),(0,s.iD)("div",o,[(0,s._)("div",c,[l,(0,s._)("div",d,[r.needRetry?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",u,m)),r.needRetry?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",v,[y,f,(0,s.Uk)(" Держите алкотестер на расстоянии 2-3 см от рта ")])),r.needRetry?((0,s.wg)(),(0,s.iD)("div",k,[w,g,(0,s.Uk)(" Снимите воронку , установите мундштук ")])):(0,s.kq)("",!0),(0,s._)("div",b,[(0,s.Uk)(" Дождитесь ГОТОВ на экране алкометра"),I,x,(0,s.Uk)(" Начните дуть с умеренной силой до окончания"),R,(0,s.Uk)(" звукового сигнала."),U,C,(0,s.Uk)(" Дуйте "+(0,a.zw)(h.status),1)])]),r.needRetry?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("p",S,[q,(0,s.Uk)(" НЕ ПРИКАСАТЬСЯ К АЛКОТЕСТЕРУ ГУБАМИ ")]))]),(0,s._)("div",D,[(0,s._)("button",{onClick:e[0]||(e[0]=t=>h.prevStep()),class:"btn opacity blue"},"Назад"),JSON.parse(h.system.alcometer_skip)?((0,s.wg)(),(0,s.iD)("button",{key:0,onClick:e[1]||(e[1]=t=>h.nextStep()),class:"btn"},"Продолжить")):(0,s.kq)("",!0)])])}n(7658);var $=n(6700),O=n(2419),J={data(){return{interval:null,seconds:5,needRetry:!1}},methods:{async saveWebCam(){if(JSON.parse(this.system.camera_photo)&&!this.inspection.photo||JSON.parse(this.system.camera_video)&&!this.inspection.video){const t=await(0,O.NO)(this.$store.state.inspection.driver_id);this.inspection.photo=t?.photo,this.inspection.video=t?.video}},async nextStep(){this.$router.push({name:"step-sleep"})},async prevStep(){this.$router.push({name:"step-thermometer"})},async retry(){this.needRetry=!0,await(0,$._)(),this.runCountdown()},hasResult(t){return!(void 0===t||null===t||"next"===t)},checkRetry(t){return this.system.alcometer_retry&&Number(t)>0&&!this.needRetry},runCountdown(){this.seconds=5,this.timerInterval=setInterval((()=>{this.seconds--,this.seconds<1&&clearInterval(this.timerInterval)}),1e3)}},async mounted(){await this.saveWebCam(),this.runCountdown(),this.requestInterval=setInterval((async()=>{const t=await(0,$.p)();this.hasResult(t)&&(this.checkRetry(t)?await this.retry():(this.inspection.alcometer_result=Number(t)||0,this.nextStep()))}),1e4)},unmounted(){clearInterval(this.requestInterval),clearInterval(this.timerInterval)},computed:{inspection(){return this.$store.state.inspection},system(){return this.$store.state.config?.system||{}},status(){return 5===this.seconds?"через "+this.seconds+" секунд":1===this.seconds?"через "+this.seconds+" секунду":this.seconds<1?" прямо сейчас!":"через "+this.seconds+" секунды"}}},z=n(89);const W=(0,z.Z)(J,[["render",N]]);var Z=W}}]);
//# sourceMappingURL=235.81db4733.js.map