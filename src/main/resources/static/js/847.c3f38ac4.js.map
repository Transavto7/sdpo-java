{"version":3,"file":"js/847.c3f38ac4.js","mappings":"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","sources":["webpack://sdpo-frontend/./src/helpers/camera.js","webpack://sdpo-frontend/./src/pages/steps/Step-alcometer.vue","webpack://sdpo-frontend/./src/pages/steps/Step-alcometer.vue?b602"],"sourcesContent":["import store from \"@/store\";\r\nimport { useToast } from \"vue-toastification\";\r\nconst toast = useToast();\r\n\r\nexport async function makePhoto() {\r\n    return await axios.post(`device/photo`).then(({ data }) => {\r\n        return data;\r\n    }).catch(defaultError);\r\n}\r\n\r\nexport async function getSizes() {\r\n    return await axios.get(`device/video/size`).then(({ data }) => {\r\n        return data;\r\n    }).catch(defaultError);\r\n}\r\n\r\n\r\nexport async function makeMedia() {\r\n    return await axios.post(`device/media`).then(({ data }) => {\r\n        return data;\r\n    }).catch(defaultError);\r\n}\r\n\r\nexport async function makeVideoTest() {\r\n    return await axios.post(`device/video/test`).then(({ data }) => {\r\n        return data;\r\n    }).catch(defaultError);\r\n}\r\n\r\nfunction defaultError(error) {\r\n    if (error.response) {\r\n        store.$state.loseConnect = true;\r\n    }\r\n    \r\n    console.log(error);\r\n}","<script>\r\nimport { getAlcometerResult } from '@/helpers/alcometer';\r\nimport { makeMedia } from '@/helpers/camera';\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            interval: null,\r\n            seconds: 5\r\n        }\r\n    },\r\n    methods: {\r\n        async saveWebCam() {\r\n            if ((JSON.parse(this.system.camera_photo) && !this.inspection.photo)\r\n                || (JSON.parse(this.system.camera_video) && !this.inspection.video)) {\r\n                const data = await makeMedia();\r\n                this.inspection.photo = data?.photo;\r\n                this.inspection.video = data?.video;\r\n            }\r\n        },\r\n        async nextStep() {\r\n            this.$router.push({ name: 'step-sleep' });\r\n        },\r\n        async prevStep() {\r\n            this.$router.push({ name: 'step-thermometer' });\r\n        }\r\n    },\r\n    async mounted() {\r\n        this.saveWebCam();\r\n        this.timerInterval = setInterval(() => {\r\n            this.seconds--;\r\n            if (this.seconds < 1) {\r\n                clearInterval(this.timerInterval);\r\n            }\r\n        }, 1000);\r\n\r\n        this.requestInterval = setInterval(async () => {\r\n            const result = await getAlcometerResult();\r\n\r\n            if (result === undefined || result === null) {\r\n                return;\r\n            }\r\n\r\n            if (result === 'next') {\r\n                return;\r\n            }\r\n\r\n            this.inspection.alcometer_result = Number(result) || 0;\r\n            this.nextStep();\r\n        }, 1000);\r\n    },\r\n    unmounted() {\r\n        clearInterval(this.requestInterval);\r\n        clearInterval(this.timerInterval);\r\n    },\r\n    computed: {\r\n        inspection() {\r\n            return this.$store.state.inspection;\r\n        },\r\n        system() {\r\n            return this.$store.state.config?.system || {};\r\n        },\r\n        status() {\r\n            if (this.seconds == 5) {\r\n                return 'через ' + this.seconds + ' секунд';\r\n            } else if (this.seconds == 1) {\r\n                return 'через ' + this.seconds + ' секунду';\r\n            } else if (this.seconds < 1) {\r\n                return ' прямо сейчас!';\r\n            } else {\r\n                return 'через ' + this.seconds + ' секунды';\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n<template>\r\n    <div class=\"step-5__outer\">\r\n        <div class=\"step-5\">\r\n            <h3 class=\"animate__animated animate__fadeInDown\">Проверка на алкоголь</h3>\r\n\r\n            <div class=\"step-5__items\">\r\n                <div class=\"step-5__item animate__animated animate__fadeInUp d-1\">\r\n                    <span>1</span>\r\n                    <img style=\"padding-right: 20px\" width=\"100\" src=\"@/assets/images/alco_guide.png\">\r\n                    Проверьте, что вставлена воронка\r\n                </div>\r\n                <div class=\"step-5__item animate__animated animate__fadeInUp d-2\">\r\n                    <span>2</span>\r\n                    <img width=\"100\" src=\"@/assets/images/alco_guide_2.png\">\r\n                    Держите алкотестер на расстоянии 2-3 см от рта\r\n                </div>\r\n                <div class=\"step-5__text  animate__animated animate__fadeInUp d-2\">\r\n                    Дождитесь ГОТОВ на экране алкометра<br><br>\r\n                    Начните дуть с умеренной силой до окончания<br>\r\n                    звукового сигнала.<br><br>\r\n\r\n                    Дуйте {{ status }}\r\n                </div>\r\n            </div>\r\n            <p class=\"alert red\">\r\n                <i class=\"ri-alarm-warning-fill\"></i>\r\n                НЕ ПРИКАСАТЬСЯ К АЛКОТЕСТЕРУ ГУБАМИ\r\n            </p>\r\n        </div>\r\n        <div class=\"step-buttons\">\r\n            <button @click=\"prevStep()\" class=\"btn opacity blue\">Назад</button>\r\n            <button @click=\"nextStep()\" v-if=\"JSON.parse(system.alcometer_skip)\" class=\"btn\">Продолжить</button>\r\n        </div>\r\n    </div>\r\n</template>","import { render } from \"./Step-alcometer.vue?vue&type=template&id=46d831b1\"\nimport script from \"./Step-alcometer.vue?vue&type=script&lang=js\"\nexport * from \"./Step-alcometer.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\ellidey\\\\IdeaProjects\\\\sdpo\\\\src\\\\main\\\\frontend\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["useToast","async","makePhoto","axios","post","then","data","catch","defaultError","getSizes","get","makeMedia","makeVideoTest","error","response","store","console","log","class","_createElementVNode","style","width","src","_imports_0","_imports_1","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_toDisplayString","$options","status","_hoisted_13","_hoisted_14","onClick","_cache","$event","prevStep","JSON","parse","system","alcometer_skip","nextStep","interval","seconds","methods","this","camera_photo","inspection","photo","camera_video","video","$router","push","name","saveWebCam","timerInterval","setInterval","clearInterval","requestInterval","result","getAlcometerResult","undefined","alcometer_result","Number","unmounted","computed","$store","state","config","__exports__","render"],"sourceRoot":""}