{"version":3,"file":"js/579.d8c3c18a.js","mappings":"+KAEA,MAAMA,GAAQC,EAAAA,EAAAA,MAEPC,eAAeC,IAClB,aAAaC,MAAMC,KAAM,oBAAmBC,MAAK,EAAGC,UACzCA,IACRC,MAAMC,EACb,CAEA,SAASA,EAAaC,GAClB,MAAMH,EAAOG,EAAMC,UAAUJ,KAC7B,GAAIA,GAAMK,QACNZ,EAAMU,MAAMH,EAAKK,cAEjB,OAAQF,GAAOC,UAAUE,QACrB,KAAK,IAAKb,EAAMU,MAAM,8BACtB,KAAK,IAAKV,EAAMU,MAAM,kBACtB,QAASV,EAAMU,MAAM,8BAI7BI,QAAQC,IAAIL,EAChB,C,+HCrBcT,EAAAA,EAAAA,MAEPC,eAAec,IAClB,aAAaZ,MAAMC,KAAM,gBAAeC,MAAK,EAAGC,UACrCA,IACRC,MAAMC,EACb,CAEOP,eAAee,IAClB,aAAab,MAAMc,IAAK,qBAAoBZ,MAAK,EAAGC,UACzCA,IACRC,MAAMC,EACb,CAEOP,eAAeiB,IAClB,aAAaf,MAAMC,KAAM,gBAAeC,MAAK,EAAGC,UACrCA,IACRC,MAAMC,EACb,CAEA,SAASA,EAAaC,GAWlBI,QAAQC,IAAIL,EAChB,C,6KCeSU,MAAM,iB,gxBA0BFA,MAAM,gB,0CA1BfC,EAAAA,EAAAA,IA8BM,MA9BNC,EA8BM,CA7BFC,GAyBAC,EAAAA,EAAAA,GAGM,MAHNC,EAGM,EAFFD,EAAAA,EAAAA,GAAgF,UAAvEE,QAAK,eAAEC,EAAAA,QAAQC,KAAK,YAAYR,MAAM,oBAAmB,SACnBS,KAAKC,MAAMC,EAAAA,OAAOC,kBAAc,WAA/EX,EAAAA,EAAAA,IAAiH,U,MAAxGK,QAAK,eAAEC,EAAAA,QAAQC,KAAK,YAAqDR,MAAM,OAAM,gBAAU,kB,yBAzEpH,GACIb,OACI,MAAO,CACH0B,SAAU,KAElB,EACAC,QAAS,CACNhC,mBACS2B,KAAKC,MAAMK,KAAKC,OAAOC,gBAAkBF,KAAKG,WAAWC,QACzDJ,KAAKG,WAAWC,YAAcvB,EAAAA,EAAAA,OAE9Ba,KAAKC,MAAMK,KAAKC,OAAOI,gBAAkBL,KAAKG,WAAWG,QACzDN,KAAKG,WAAWG,YAActB,EAAAA,EAAAA,MAEtC,GAEJjB,gBACIiC,KAAKO,aAELP,KAAKF,SAAWU,aAAYzC,UACxB,MAAM0C,QAAezC,EAAAA,EAAAA,KAEN,SAAXyC,IAIJT,KAAKG,WAAWO,iBAAmBC,OAAOF,IAAW,EACrDG,cAAcZ,KAAKF,UACnBE,KAAKa,QAAQpB,KAAK,WAAU,GAC7B,IACP,EACAqB,YACIF,cAAcZ,KAAKF,SACvB,EACAiB,SAAU,CACNZ,aACI,OAAOH,KAAKgB,OAAOC,MAAMd,UAC7B,EACAF,SACI,OAAOD,KAAKgB,OAAOC,MAAMC,QAAQjB,QAAU,CAAC,CAChD,I,QCvCR,MAAMkB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://sdpo-frontend/./src/helpers/alcometer.js","webpack://sdpo-frontend/./src/helpers/camera.js","webpack://sdpo-frontend/./src/pages/steps/Step-5.vue","webpack://sdpo-frontend/./src/pages/steps/Step-5.vue?18a3"],"sourcesContent":["import store from \"@/store\";\nimport { useToast } from \"vue-toastification\";\nconst toast = useToast();\n\nexport async function getAlcometerResult() {\n    return await axios.post(`device/alcometer`).then(({ data }) => {            \n        return data;\n    }).catch(defaultError);\n}\n\nfunction defaultError(error) {\n    const data = error.response?.data;\n    if (data?.message) {\n        toast.error(data.message);\n    } else {\n        switch (error?.response?.status) {\n            case 400: toast.error('Ошибка авторизации запроса')\n            case 500: toast.error('Ошибка сервера')\n            default: toast.error('Неизвестная ошибка запроса')\n        }\n    }\n    \n    console.log(error);\n}","import store from \"@/store\";\nimport { useToast } from \"vue-toastification\";\nconst toast = useToast();\n\nexport async function makePhoto() {\n    return await axios.post(`device/photo`).then(({ data }) => {\n        return data;\n    }).catch(defaultError);\n}\n\nexport async function getSizes() {\n    return await axios.get(`device/video/size`).then(({ data }) => {\n        return data;\n    }).catch(defaultError);\n}\n\nexport async function makeVideo() {\n    return await axios.post(`device/video`).then(({ data }) => {\n        return data;\n    }).catch(defaultError);\n}\n\nfunction defaultError(error) {\n    // const data = error.response?.data;\n    // if (data?.message) {\n    //     toast.error(data.message);\n    // } else {    \n    //     switch (error?.response?.status) {\n    //         case 400: toast.error('Ошибка авторизации запроса')\n    //         default: toast.error('Неизвестная ошибка запроса')\n    //     }\n    // }\n    \n    console.log(error);\n}","<script>\nimport { getAlcometerResult } from '@/helpers/alcometer';\nimport { makePhoto, makeVideo } from '@/helpers/camera';\n\nexport default {\n    data() {\n        return {\n            interval: null,\n        }\n    },\n    methods: {\n       async saveWebCam() {\n            if (JSON.parse(this.system.camera_photo) && !this.inspection.photo) {\n                this.inspection.photo = await makePhoto();\n            }\n            if (JSON.parse(this.system.camera_video) && !this.inspection.video) {\n                this.inspection.video = await makeVideo();\n            }\n        }\n    },\n    async mounted() {\n        this.saveWebCam();\n\n        this.interval = setInterval(async () => {\n            const result = await getAlcometerResult();\n\n            if (result === 'next') {\n                return;\n            }\n\n            this.inspection.alcometer_result = Number(result) || 0;\n            clearInterval(this.interval);\n            this.$router.push('/step/6');\n        }, 1000);\n    },\n    unmounted() {\n        clearInterval(this.interval);\n    },\n    computed: {\n        inspection() {\n            return this.$store.state.inspection;\n        },\n        system() {\n            return this.$store.state.config?.system || {};\n        }\n    }\n}\n</script>\n<template>\n    <div class=\"step-5__outer\">\n        <div class=\"step-5\">\n            <h3 class=\"animate__animated animate__fadeInDown\">Проверка на алкоголь</h3>\n\n            <div class=\"step-5__items\">\n                <div class=\"step-5__item animate__animated animate__fadeInUp d-1\">\n                    <span>1</span>\n                    <img style=\"padding-right: 20px\" width=\"100\" src=\"@/assets/images/alco_guide.png\">\n                    Проверьте, что вставлена воронка\n                </div>\n                <div class=\"step-5__item animate__animated animate__fadeInUp d-2\">\n                    <span>2</span>\n                    <img width=\"100\" src=\"@/assets/images/alco_guide_2.png\">\n                    Держите алкотестер на расстоянии 2-3 см от рта\n                </div>\n                <div class=\"step-5__text  animate__animated animate__fadeInUp d-2\">\n                    Дождитесь ГОТОВ на экране алкометра<br><br>\n                    Начните дуть с умеренной силой до окончания<br>\n                    звукового сигнала.<br><br>\n                </div>\n            </div>\n            <p class=\"alert red\">\n                <i class=\"ri-alarm-warning-fill\"></i>\n                НЕ ПРИКАСАТЬСЯ К АЛКОТЕСТЕРУ ГУБАМИ\n            </p>\n        </div>\n        <div class=\"step-buttons\">\n            <button @click=\"$router.push('/step/4')\" class=\"btn opacity blue\">Назад</button>\n            <button @click=\"$router.push('/step/6')\" v-if=\"JSON.parse(system.alcometer_skip)\" class=\"btn\">Продолжить</button>\n        </div>\n    </div>\n</template>","import { render } from \"./Step-5.vue?vue&type=template&id=778c0b16\"\nimport script from \"./Step-5.vue?vue&type=script&lang=js\"\nexport * from \"./Step-5.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/ellidey/web/sdpo/src/main/frontend/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["toast","useToast","async","getAlcometerResult","axios","post","then","data","catch","defaultError","error","response","message","status","console","log","makePhoto","getSizes","get","makeVideo","class","_createElementBlock","_hoisted_1","_hoisted_2","_createElementVNode","_hoisted_3","onClick","_ctx","push","JSON","parse","$options","alcometer_skip","interval","methods","this","system","camera_photo","inspection","photo","camera_video","video","saveWebCam","setInterval","result","alcometer_result","Number","clearInterval","$router","unmounted","computed","$store","state","config","__exports__","render"],"sourceRoot":""}