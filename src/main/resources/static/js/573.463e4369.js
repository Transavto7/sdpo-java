"use strict";(self["webpackChunksdpo_frontend"]=self["webpackChunksdpo_frontend"]||[]).push([[573],{7557:function(t,e,n){n.d(e,{Z:function(){return _}});var i=n(3396);const s={class:"number-buttons",ref:"numbers"},r=(0,i._)("i",{class:"ri-close-fill"},null,-1),a=[r],o=(0,i._)("i",{class:"ri-delete-back-line"},null,-1),d=[o];function u(t,e,n,r,o,u){return(0,i.wg)(),(0,i.iD)("div",s,[(0,i._)("button",{class:"number-buttons__item",onClick:e[0]||(e[0]=t=>u.pushIntoNumber("1"))},"1"),(0,i._)("button",{class:"number-buttons__item",onClick:e[1]||(e[1]=t=>u.pushIntoNumber("2"))},"2"),(0,i._)("button",{class:"number-buttons__item",onClick:e[2]||(e[2]=t=>u.pushIntoNumber("3"))},"3"),(0,i._)("button",{class:"number-buttons__item",onClick:e[3]||(e[3]=t=>u.pushIntoNumber("4"))},"4"),(0,i._)("button",{class:"number-buttons__item",onClick:e[4]||(e[4]=t=>u.pushIntoNumber("5"))},"5"),(0,i._)("button",{class:"number-buttons__item",onClick:e[5]||(e[5]=t=>u.pushIntoNumber("6"))},"6"),(0,i._)("button",{class:"number-buttons__item",onClick:e[6]||(e[6]=t=>u.pushIntoNumber("7"))},"7"),(0,i._)("button",{class:"number-buttons__item",onClick:e[7]||(e[7]=t=>u.pushIntoNumber("8"))},"8"),(0,i._)("button",{class:"number-buttons__item",onClick:e[8]||(e[8]=t=>u.pushIntoNumber("9"))},"9"),(0,i._)("button",{class:"number-buttons__item",onClick:e[9]||(e[9]=t=>u.clearPassword())},a),(0,i._)("button",{class:"number-buttons__item",onClick:e[10]||(e[10]=t=>u.pushIntoNumber("0"))},"0"),(0,i._)("button",{class:"number-buttons__item",onClick:e[11]||(e[11]=t=>u.popIntoNumber())},d)],512)}var l={name:"InputNumber",methods:{pushIntoNumber(t){this.$emit("pushIntoNumber",t)},popIntoNumber(){this.$emit("popIntoNumber")},clearPassword(){this.$emit("clearNumber")}},mounted(){this.$refs.numbers.querySelectorAll("button").forEach(((t,e)=>{t.classList.add("animate__animated"),t.classList.add("animate__fadeInUp"),t.style.setProperty("animation-delay",.6+.05*e+"s")}))}},c=n(89);const m=(0,c.Z)(l,[["render",u]]);var _=m},9775:function(t,e,n){n.d(e,{Z:function(){return u}});var i=n(3396);function s(t,e,n,s,r,a){const o=(0,i.up)("input-number");return(0,i.wg)(),(0,i.j4)(o,{onPushIntoNumber:e[0]||(e[0]=t=>a.pushCharIntoPassword(t)),onPopIntoNumber:e[1]||(e[1]=()=>a.extractLastCharIntoPassword()),onClearNumber:e[2]||(e[2]=()=>a.clearPassword())})}var r=n(7557),a={name:"InputPersonalNumberForm",components:{InputNumber:r.Z},data(){return{password:""}},methods:{pushCharIntoPassword(t){this.password+=t},extractLastCharIntoPassword(){this.password=this.password.slice(0,-1)},clearPassword(){this.password=""},emitPass(){this.$emit("password",this.password)}},watch:{password:function(){this.emitPass()}}},o=n(89);const d=(0,o.Z)(a,[["render",s]]);var u=d},5573:function(t,e,n){n.r(e),n.d(e,{default:function(){return E}});var i=n(3396);function s(t,e,n,s,r,a){const o=(0,i.up)("print-login"),d=(0,i.up)("print-index"),u=(0,i.up)("loader");return(0,i.wg)(),(0,i.iD)(i.HY,null,[this.login||this.loading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(o,{key:0,onSuccessAuth:e[0]||(e[0]=t=>a.setDriver(t))})),this.login&&!this.loading?((0,i.wg)(),(0,i.j4)(d,{key:1,onPrint:e[1]||(e[1]=t=>a.printQuery(t)),inspections:r.inspections,"onUpdate:inspections":e[2]||(e[2]=t=>r.inspections=t),driver:r.driver,"onUpdate:driver":e[3]||(e[3]=t=>r.driver=t)},null,8,["inspections","driver"])):(0,i.kq)("",!0),(0,i.Wm)(u,{loading:r.loading,"onUpdate:loading":e[4]||(e[4]=t=>r.loading=t)},null,8,["loading"])],64)}n(7658);var r=n(7139),a=n(9242);const o={class:"home"},d={class:"driver-form"},u={key:0,class:"driver-form__title animate__animated animate__fadeInDown d-2"},l={key:1,class:"driver-form__title animate__animated animate__fadeInDown d-2"},c={class:"driver-form__input"},m={key:2,class:"driver-form__not-found animate__animated animate__fadeInUp"};function _(t,e,n,s,_,p){const h=(0,i.up)("input-personal-number-form");return(0,i.wg)(),(0,i.iD)("div",o,[(0,i._)("div",d,[_.driver.driver_fio?((0,i.wg)(),(0,i.iD)("div",u,(0,r.zw)(_.driver.driver_fio),1)):((0,i.wg)(),(0,i.iD)("div",l," Введите ваш идентификатор ")),(0,i._)("div",c,[(0,i.wy)((0,i._)("input",{type:"number",class:"animate__animated animate__fadeIn d-5","onUpdate:modelValue":e[0]||(e[0]=t=>_.driver_id=t),onInput:e[1]||(e[1]=(...t)=>p.checkDriver&&p.checkDriver(...t))},null,544),[[a.nr,_.driver_id]])]),(0,i.Wm)(h,{onPassword:e[2]||(e[2]=t=>p.updateDriverId(t))}),_.error?((0,i.wg)(),(0,i.iD)("div",m,(0,r.zw)(_.error),1)):(0,i.kq)("",!0)])])}var p=n(9775),h=n(6509),v=n(4677),b={components:{InputPersonalNumberForm:p.Z},data(){return{driver_id:"",driver:{},error:"",toast:(0,v.pm)(),loading:!1}},methods:{async start(){this.$emit("success-auth",this.driver)},updateDriverId(t){this.driver_id=t},async checkDriver(){if(this.error=null,!(this.driver_id.length<6)){this.loading=!0;try{const t=await(0,h.L$)(this.driver_id);t?(this.driver=t,this.error=null,await this.start()):this.error="Водитель не найден"}catch(t){this.error=t.response?.data?.message||"Неизвестная ошибка"}this.loading=!1}}},watch:{driver_id:function(t){this.checkDriver(),this.hasDriver||(this.processingApproval=!1)}},computed:{config(){return this.$store.state.config},hasDriver(){return this.driver.driver_id&&!this.error}},mounted(){}},w=n(89);const f=(0,w.Z)(b,[["render",_]]);var g=f;const k={class:"last-inspection"},I={class:"last-inspection__header"},D={class:"last-inspection_body"},y={class:"content-block__calendar"},N={key:0,class:"content-block__table"},P=(0,i._)("thead",null,[(0,i._)("tr",null,[(0,i._)("th",{style:{width:"40%"}},"Дата Время"),(0,i._)("th",null,"Тип осмотра"),(0,i._)("th")])],-1),C={class:"animate__animated animate__fadeInUp"},U={class:"animate__animated animate__fadeInUp"},Z={class:"time"},F=["onClick"],$=(0,i._)("i",{class:"ri-printer-fill"},null,-1),q=[$],x={key:1,class:"content-block__warning"},L=(0,i._)("div",{class:"driver-form__not-found animate__animated animate__fadeInUp"},"Осмотры на выбранную дату не проводились ",-1),S=[L];function z(t,e,n,s,a,o){const d=(0,i.up)("VueDatePicker");return(0,i.wg)(),(0,i.iD)("div",k,[(0,i._)("div",I,[(0,i._)("h1",null,(0,r.zw)(n.driver.fio),1)]),(0,i._)("div",D,[(0,i._)("div",y,[(0,i.Wm)(d,{modelValue:a.date,"onUpdate:modelValue":e[0]||(e[0]=t=>a.date=t),inline:"","auto-apply":"","disable-year-select":!0,locale:"ru","hide-navigation":["month","time","hours","seconds"],"min-date":o.firstDayLastMonth,"max-date":o.dateNow,"prevent-min-max-navigation":"",markers:a.dateFiltered},null,8,["modelValue","min-date","max-date","markers"])]),o.hasSelectInspections?((0,i.wg)(),(0,i.iD)("div",N,[(0,i._)("table",null,[P,(0,i._)("tbody",C,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.inspectionsFiltered,(t=>((0,i.wg)(),(0,i.iD)("tr",U,[(0,i._)("td",Z,(0,r.zw)(o.getTimeOnly(t.created_at)),1),(0,i._)("td",null,(0,r.zw)(t.type_view),1),(0,i._)("td",null,[(0,i._)("a",{class:"btn icon",onClick:e=>o.print(t)},q,8,F)])])))),256))])])])):(0,i.kq)("",!0),o.hasSelectInspections?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",x,S))])])}var V=n(7190),j={components:{VueDatePicker:V.Z},props:{inspections:{type:Object,require:!0,default:()=>({})},driver:{type:Object,require:!0}},data(){return{date:new Date,inspectionsFiltered:[],dateFiltered:[]}},methods:{getTimeOnly(t){return new Date(t).toTimeString().split(" ")[0]},print(t){this.$emit("print",t)},initDateRange(){if(this.hasInspections)for(const t of this.inspections)this.dateFiltered.push({date:t.created_at,type:"line",color:"red"})}},watch:{date(){if(this.inspectionsFiltered=[],this.hasInspections)for(const t of this.inspections)new Date(t.created_at).toDateString()===new Date(this.date).toDateString()&&this.inspectionsFiltered.push(t)}},computed:{dateNow(){return new Date},firstDayLastMonth(){let t=new Date;return t.setMonth(t.getMonth()-1,1),t},hasSelectInspections(){return this.inspectionsFiltered.length>0},hasInspections(){return this.inspections.length>0}},mounted(){this.initDateRange(),this.date=this.dateNow},unmounted(){}};const A=(0,w.Z)(j,[["render",z]]);var M=A;const O={key:0,class:"admin__loading animate__animated animate__fadeInUp",style:{"z-index":"3"}},H=(0,i._)("div",{class:"lds-ring"},[(0,i._)("div"),(0,i._)("div"),(0,i._)("div"),(0,i._)("div")],-1);function T(t,e,n,s,r,a){return n.loading?((0,i.wg)(),(0,i.iD)("div",O,[H,(0,i.Uk)(" Загрузка ")])):(0,i.kq)("",!0)}var W={props:{loading:{type:Boolean,default:!1}}};const Q=(0,w.Z)(W,[["render",T]]);var R=Q,Y={components:{Loader:R,PrintIndex:M,PrintLogin:g},data(){return{driver:null,toast:(0,v.pm)(),inspections:{},print:!1,errorAuthentication:!1,loading:!1}},methods:{async confirmPrint(t){await(0,h.xH)(t),this.toast.success("Задание на печать отправлено"),this.$router.push("/")},printQuery(t){this.confirmPrint(t)},async setDriver(t){this.loading=!0,this.inspections=await(0,h.vs)(t.hash_id),this.driver=t,this.loading=!1}},computed:{login(){return null!==this.driver}}};const B=(0,w.Z)(Y,[["render",s]]);var E=B}}]);
//# sourceMappingURL=573.463e4369.js.map