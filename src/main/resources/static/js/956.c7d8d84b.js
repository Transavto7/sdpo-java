"use strict";(self["webpackChunksdpo_frontend"]=self["webpackChunksdpo_frontend"]||[]).push([[956],{2136:function(t,e,n){n.d(e,{Z:function(){return _}});var i=n(3396);const s={class:"number-buttons",ref:"numbers"},r=(0,i._)("i",{class:"ri-close-fill"},null,-1),a=[r],o=(0,i._)("i",{class:"ri-delete-back-line"},null,-1),d=[o];function l(t,e,n,r,o,l){return(0,i.wg)(),(0,i.iD)("div",s,[(0,i._)("button",{class:"number-buttons__item",onClick:e[0]||(e[0]=t=>l.pushCharIntoPassword("1"))},"1"),(0,i._)("button",{class:"number-buttons__item",onClick:e[1]||(e[1]=t=>l.pushCharIntoPassword("2"))},"2"),(0,i._)("button",{class:"number-buttons__item",onClick:e[2]||(e[2]=t=>l.pushCharIntoPassword("3"))},"3"),(0,i._)("button",{class:"number-buttons__item",onClick:e[3]||(e[3]=t=>l.pushCharIntoPassword("4"))},"4"),(0,i._)("button",{class:"number-buttons__item",onClick:e[4]||(e[4]=t=>l.pushCharIntoPassword("5"))},"5"),(0,i._)("button",{class:"number-buttons__item",onClick:e[5]||(e[5]=t=>l.pushCharIntoPassword("6"))},"6"),(0,i._)("button",{class:"number-buttons__item",onClick:e[6]||(e[6]=t=>l.pushCharIntoPassword("7"))},"7"),(0,i._)("button",{class:"number-buttons__item",onClick:e[7]||(e[7]=t=>l.pushCharIntoPassword("8"))},"8"),(0,i._)("button",{class:"number-buttons__item",onClick:e[8]||(e[8]=t=>l.pushCharIntoPassword("9"))},"9"),(0,i._)("button",{class:"number-buttons__item",onClick:e[9]||(e[9]=t=>l.clearPassword())},a),(0,i._)("button",{class:"number-buttons__item",onClick:e[10]||(e[10]=t=>l.pushCharIntoPassword("0"))},"0"),(0,i._)("button",{class:"number-buttons__item",onClick:e[11]||(e[11]=t=>l.extractLastCharIntoPassword())},d)],512)}var u={data(){return{password:""}},methods:{pushCharIntoPassword(t){this.password+=t},extractLastCharIntoPassword(){this.password=this.password.slice(0,-1)},clearPassword(){this.password=""},emitPass(){this.$emit("password",this.password)}},watch:{password:function(){this.emitPass()}},mounted(){this.$refs.numbers.querySelectorAll("button").forEach(((t,e)=>{t.classList.add("animate__animated"),t.classList.add("animate__fadeInUp"),t.style.setProperty("animation-delay",.6+.05*e+"s")}))}},c=n(89);const h=(0,c.Z)(u,[["render",l]]);var _=h},7956:function(t,e,n){n.r(e),n.d(e,{default:function(){return Y}});var i=n(3396);function s(t,e,n,s,r,a){const o=(0,i.up)("print-login"),d=(0,i.up)("print-index"),l=(0,i.up)("loader");return(0,i.wg)(),(0,i.iD)(i.HY,null,[this.login?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(o,{key:0,onSuccessAuth:e[0]||(e[0]=t=>a.setDriver(t))})),this.login&&!this.hasQuery?((0,i.wg)(),(0,i.j4)(d,{key:1,onPrint:e[1]||(e[1]=t=>a.printQuery(t)),inspections:r.inspections,"onUpdate:inspections":e[2]||(e[2]=t=>r.inspections=t),driver:r.driver,"onUpdate:driver":e[3]||(e[3]=t=>r.driver=t)},null,8,["inspections","driver"])):(0,i.kq)("",!0),this.login&&this.hasQuery?((0,i.wg)(),(0,i.j4)(o,{key:2,onSuccessAuth:e[4]||(e[4]=t=>a.setDriverIdRequest(t))})):(0,i.kq)("",!0),(0,i.Wm)(l,{loading:r.loading,"onUpdate:loading":e[5]||(e[5]=t=>r.loading=t)},null,8,["loading"])],64)}n(7658);var r=n(7139),a=n(9242);const o={class:"home"},d={class:"driver-form"},l={key:0,class:"driver-form__title animate__animated animate__fadeInDown d-2"},u={key:1,class:"driver-form__title animate__animated animate__fadeInDown d-2"},c={class:"driver-form__input"},h={key:2,class:"driver-form__not-found animate__animated animate__fadeInUp"};function _(t,e,n,s,_,p){const m=(0,i.up)("input-personal-number-form");return(0,i.wg)(),(0,i.iD)("div",o,[(0,i._)("div",d,[_.driver.driver_fio?((0,i.wg)(),(0,i.iD)("div",l,(0,r.zw)(_.driver.driver_fio),1)):((0,i.wg)(),(0,i.iD)("div",u," Введите ваш идентификатор ")),(0,i._)("div",c,[(0,i.wy)((0,i._)("input",{type:"number",class:"animate__animated animate__fadeIn d-5","onUpdate:modelValue":e[0]||(e[0]=t=>_.driver_id=t),onInput:e[1]||(e[1]=(...t)=>p.checkDriver&&p.checkDriver(...t))},null,544),[[a.nr,_.driver_id]])]),(0,i.Wm)(m,{onPassword:e[2]||(e[2]=t=>p.updateDriverId(t))}),_.error?((0,i.wg)(),(0,i.iD)("div",h,(0,r.zw)(_.error),1)):(0,i.kq)("",!0)])])}var p=n(2136),m=n(6509),v=n(4677),w={components:{InputPersonalNumberForm:p.Z},data(){return{driver_id:"",driver:{},error:"",toast:(0,v.pm)(),loading:!1}},methods:{async start(){this.$emit("success-auth",this.driver)},updateDriverId(t){this.driver_id=t},async checkDriver(){if(this.error=null,!(this.driver_id.length<6)){this.loading=!0;try{const t=await(0,m.L$)(this.driver_id);t?(this.driver=t,this.error=null,await this.start()):this.error="Водитель не найден"}catch(t){this.error=t.response?.data?.message||"Неизвестная ошибка"}this.loading=!1}}},watch:{driver_id:function(t){this.checkDriver(),this.hasDriver||(this.processingApproval=!1)}},computed:{config(){return this.$store.state.config},hasDriver(){return this.driver.driver_id&&!this.error}},mounted(){}},b=n(89);const g=(0,b.Z)(w,[["render",_]]);var f=g;const k={class:"last-inspection"},y={class:"last-inspection__header"},D={class:"last-inspection_body"},I={class:"content-block__calendar"},C={key:0,class:"content-block__table"},P=(0,i._)("thead",null,[(0,i._)("tr",null,[(0,i._)("th",null,"Дата Время"),(0,i._)("th",null,"Тип осмотра"),(0,i._)("th")])],-1),q=["onClick"],U=(0,i._)("i",{class:"ri-printer-fill"},null,-1),L=[U],x={key:1,class:"content-block__warning"},Z=(0,i._)("div",{class:"driver-form__not-found animate__animated animate__fadeInUp"},"Ранее осмотры не проводились",-1),A=[Z];function S(t,e,n,s,a,o){const d=(0,i.up)("VueDatePicker");return(0,i.wg)(),(0,i.iD)("div",k,[(0,i._)("div",y,[(0,i._)("h1",null,(0,r.zw)(n.driver.fio),1)]),(0,i._)("div",D,[(0,i._)("div",I,[(0,i.Wm)(d,{modelValue:a.date,"onUpdate:modelValue":e[0]||(e[0]=t=>a.date=t),inline:"","auto-apply":"","disable-year-select":!0,"disabled-times":"",locale:"ru","hide-navigation":["month","time","hours","seconds"],"min-date":o.firstDayLastMonth,"max-date":o.dateNow,"prevent-min-max-navigation":""},null,8,["modelValue","min-date","max-date"])]),o.hasInspections?((0,i.wg)(),(0,i.iD)("div",C,[(0,i._)("table",null,[P,(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.inspections,(t=>((0,i.wg)(),(0,i.iD)("tr",null,[(0,i._)("td",null,(0,r.zw)(t.created_at),1),(0,i._)("td",null,(0,r.zw)(t.type_view),1),(0,i._)("td",null,[(0,i._)("a",{class:"btn icon",onClick:e=>o.print(t)},L,8,q)])])))),256))])])])):(0,i.kq)("",!0),o.hasInspections?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",x,A))])])}var $=n(7190),Q={components:{VueDatePicker:$.Z},props:{inspections:{type:Array,require:!0,default:[]},driver:{type:Object,require:!0}},data(){return{date:new Date}},methods:{print(t){this.$emit("print",t)},getDates(){let t=[];for(const e of JSON.parse(JSON.stringify(this.inspections)))new Date(e.created_at).toDateString()===new Date(this.date).toDateString()&&(t[e.created_at]={date:e.created_at,type:"line",color:"red"});return t}},watch:{},computed:{dateNow(){return new Date},firstDayLastMonth(){let t=new Date;return t.setMonth(t.getMonth()-1,1),t},hasInspections(){return this.inspections.length>0}},mounted(){}};const V=(0,b.Z)(Q,[["render",S]]);var z=V;const N={key:0,class:"admin__loading animate__animated animate__fadeInUp"},R=(0,i._)("div",{class:"lds-ring"},[(0,i._)("div"),(0,i._)("div"),(0,i._)("div"),(0,i._)("div")],-1);function j(t,e,n,s,r,a){return n.loading?((0,i.wg)(),(0,i.iD)("div",N,[R,(0,i.Uk)(" Загрузка ")])):(0,i.kq)("",!0)}var M={props:{loading:{type:Boolean,default:!1}}};const H=(0,b.Z)(M,[["render",j]]);var O=H,W={components:{Loader:O,PrintIndex:z,PrintLogin:f},data(){return{driver:null,driverId:null,inspection:{},inspections:{},print:!1,errorAuthentication:!1,loading:!1,hasQuery:!1}},methods:{async confirmPrint(){console.log("print"),await(0,m.xH)(this.inspection),console.log("stop print"),this.$router.push("/")},printQuery(t){console.log(t),this.hasQuery=!0,this.inspection=t},async setDriver(t){this.driver=t,this.driverId=t.hash_id,this.loading=!0,this.inspections=await(0,m.vs)(t.hash_id),this.loading=!1},setDriverIdRequest(t){this.driverIdRequest=t,console.log(this.driverIdRequest),console.log(this.driver),this.driverIdRequest.hash_id===this.driver.hash_id?this.confirmPrint():this.errorAuthentication=!0}},computed:{login(){return null!==this.driverId}}};const J=(0,b.Z)(W,[["render",s]]);var Y=J}}]);
//# sourceMappingURL=956.c7d8d84b.js.map