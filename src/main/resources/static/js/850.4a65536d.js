"use strict";(self["webpackChunksdpo_frontend"]=self["webpackChunksdpo_frontend"]||[]).push([[850],{2419:function(e,t,n){n.d(t,{NO:function(){return o},TQ:function(){return r},af:function(){return i},o:function(){return c}});var s=n(7625),a=n(4677);(0,a.pm)();async function i(){return await axios.post("device/photo").then((({data:e})=>e)).catch(l)}async function r(){return await axios.get("device/video/size").then((({data:e})=>e)).catch(l)}async function o(e){return await axios.post("device/media",{driver_id:e}).then((({data:e})=>e)).catch(l)}async function c(){return await axios.post("device/video/test").then((({data:e})=>e)).catch(l)}function l(e){e.response&&(s.Z.$state.loseConnect=!0),console.log(e)}},7996:function(e,t,n){n.r(t),n.d(t,{default:function(){return W}});var s=n(3396),a=n(7139),i=n.p+"img/alco_guide.a6a48b74.png",r=n.p+"img/alco_guide_2.a5bbcd2d.png";const o={class:"step-alcometer__outer"},c={class:"step-alcometer"},l=(0,s._)("h3",{class:"animate__animated animate__fadeInDown"},"Проверка на алкоголь",-1),d={class:"step-alcometer__items"},u={key:0,class:"step-alcometer__item animate__animated animate__fadeInUp d-1"},h=(0,s._)("span",null,"1",-1),p=(0,s._)("img",{style:{"padding-right":"20px"},width:"100",src:i},null,-1),m=(0,s._)("label",null,"Проверьте, что вставлена воронка",-1),_=[h,p,m],y={key:1,class:"step-alcometer__item animate__animated animate__fadeInUp d-2"},v=(0,s._)("span",null,"2",-1),f=(0,s._)("img",{width:"100",src:r},null,-1),w={key:2,class:"step-alcometer__item animate__animated animate__fadeInUp d-1"},k=(0,s._)("span",{style:{"min-height":"30px"}},"3",-1),g=(0,s._)("img",{style:{"padding-right":"20px"},width:"100",src:i},null,-1),b={class:"step-alcometer__text animate__animated animate__fadeInUp d-2"},I=(0,s._)("br",null,null,-1),R=(0,s._)("br",null,null,-1),x=(0,s._)("br",null,null,-1),U=(0,s._)("br",null,null,-1),C=(0,s._)("br",null,null,-1),S={key:0,class:"alert red"},q=(0,s._)("i",{class:"ri-alarm-warning-fill"},null,-1),D={class:"step-buttons"};function N(e,t,n,i,r,h){return(0,s.wg)(),(0,s.iD)("div",o,[(0,s._)("div",c,[l,(0,s._)("div",d,[r.needRetry?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",u,_)),r.needRetry?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",y,[v,f,(0,s.Uk)(" Держите алкотестер на расстоянии 2-3 см от рта ")])),r.needRetry?((0,s.wg)(),(0,s.iD)("div",w,[k,g,(0,s.Uk)(" Снимите воронку , установите мундштук ")])):(0,s.kq)("",!0),(0,s._)("div",b,[(0,s.Uk)(" Дождитесь ГОТОВ на экране алкометра"),I,R,(0,s.Uk)(" Начните дуть с умеренной силой до окончания"),x,(0,s.Uk)(" звукового сигнала."),U,C,(0,s.Uk)(" Дуйте "+(0,a.zw)(h.status),1)])]),r.needRetry?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("p",S,[q,(0,s.Uk)(" НЕ ПРИКАСАТЬСЯ К АЛКОТЕСТЕРУ ГУБАМИ ")]))]),(0,s._)("div",D,[(0,s._)("button",{onClick:t[0]||(t[0]=e=>h.prevStep()),class:"btn opacity blue"},"Назад"),JSON.parse(h.system.alcometer_skip)?((0,s.wg)(),(0,s.iD)("button",{key:0,onClick:t[1]||(t[1]=e=>h.nextStep()),class:"btn"},"Продолжить")):(0,s.kq)("",!0)])])}n(7658);var $=n(6700),O=n(2419),J={data(){return{interval:null,seconds:5,needRetry:!1}},methods:{async saveWebCam(){if(JSON.parse(this.system.camera_photo)&&!this.inspection.photo||JSON.parse(this.system.camera_video)&&!this.inspection.video){const e=await(0,O.NO)(this.$store.state.inspection.driver_id);this.inspection.photo=e?.photo,this.inspection.video=e?.video}},async nextStep(){this.$router.push({name:"step-sleep"})},async prevStep(){this.$router.push({name:"step-thermometer"})},async retry(){this.needRetry=!0},hasResult(e){return!(void 0===e||null===e||"next"===e)},runCountdown(){this.seconds=5,this.timerInterval=setInterval((()=>{this.seconds--,this.seconds<1&&clearInterval(this.timerInterval)}),1e3)},async checkReadyAlcometerRetry(){if(this.system.alcometer_retry)return!this.needRetry&&(this.needRetry&&(await(0,$.dS)(),this.runCountdown()),!0)}},async mounted(){await this.saveWebCam(),await(0,$.dS)(),this.runCountdown(),this.requestInterval=setInterval((async()=>{if(!await this.checkReadyAlcometerRetry())return;const e=await(0,$.pe)();this.hasResult(e)&&(this.system.alcometer_retry&&Number(e)>0&&!this.needRetry?await this.retry():(this.inspection.alcometer_result=Number(e)||0,this.nextStep()))}),1e3)},unmounted(){clearInterval(this.requestInterval),clearInterval(this.timerInterval)},computed:{inspection(){return this.$store.state.inspection},system(){return this.$store.state.config?.system||{}},status(){return 5===this.seconds?"через "+this.seconds+" секунд":1===this.seconds?"через "+this.seconds+" секунду":this.seconds<1?" прямо сейчас!":"через "+this.seconds+" секунды"}}},z=n(89);const A=(0,z.Z)(J,[["render",N]]);var W=A}}]);
//# sourceMappingURL=850.4a65536d.js.map